!function(){"use strict";var e=document.getElementById("resultats-container"),t=document.getElementById("results-count"),n=document.getElementById("filter-year"),a=document.getElementById("filter-circuit"),r=document.getElementById("filter-competition"),i=document.getElementById("filter-categorie"),o=document.getElementById("filter-podium"),c=document.getElementById("filter-reset"),s=document.getElementById("expand-all");if(e){var u=!1,l={},d=["jan.","fÃ©v.","mars","avr.","mai","juin","juil.","aoÃ»t","sept.","oct.","nov.","dÃ©c."],f={date:"Date",circuit:"Circuit",categorie:"CatÃ©gorie",chrono:"Chrono",m1:"M1",m2:"M2",m3:"M3",cumul:"Cumul",prefinale:"PrÃ©-Finale","finale 1":"Finale 1","finale 2":"Finale 2","finale 3":"Finale 3",finale:"Finale",finaleB:"Finale B"},m=["date","circuit","categorie","chrono","m1","m2","m3","cumul","prefinale","finale 1","finale 2","finale 3","finale","finaleB"],p=["dateDebut","dateFin","manche","annee","nom","courses","competition","dnf","annulee","pays"],v={FR:"ðŸ‡«ðŸ‡·",IT:"ðŸ‡®ðŸ‡¹",DE:"ðŸ‡©ðŸ‡ª",BE:"ðŸ‡§ðŸ‡ª",ES:"ðŸ‡ªðŸ‡¸",GB:"ðŸ‡¬ðŸ‡§",NL:"ðŸ‡³ðŸ‡±",PT:"ðŸ‡µðŸ‡¹"},h=["chrono","cumul","prefinale","finale","finale 1","finale 2","finale 3","finaleB","m1","m2","m3"];n&&n.addEventListener("change",x),a&&a.addEventListener("change",x),r&&r.addEventListener("change",x),i&&i.addEventListener("change",x),o&&o.addEventListener("change",x),c&&c.addEventListener("click",function(){n.value="",a.value="",r.value="",i&&(i.value=""),o.value="",x()}),s&&s.addEventListener("click",function(){var e=document.querySelectorAll(".season-btn"),t=document.querySelectorAll(".season-content");if(u=!u,e.forEach(function(e){u?(e.classList.add("active"),e.setAttribute("aria-expanded","true")):(e.classList.remove("active"),e.setAttribute("aria-expanded","false"))}),t.forEach(function(e){u?e.classList.add("active"):e.classList.remove("active")}),s){var n=s.querySelector(".expand-icon"),a=s.querySelector(".expand-text");u?(n.textContent="âˆ’",a.textContent="Tout replier"):(n.textContent="+",a.textContent="Tout dÃ©plier")}}),fetch("/data/resultats.json").then(function(e){if(!e.ok)throw new Error("Erreur de chargement");return e.json()}).then(function(e){0;var t=y(e);l=t,function(e,t){var o=new Set,c=new Set,s=new Set;e.competitions.forEach(function(e){c.add(e.nom),s.add(e.categorie),e.courses&&e.courses.forEach(function(e){e.circuit&&o.add(e.circuit),e.categorie&&s.add(e.categorie)})}),t.forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)}),Array.from(o).sort().forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=e,a.appendChild(t)}),Array.from(c).sort().forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=e,r.appendChild(t)}),i&&Array.from(s).sort().forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=e,i.appendChild(t)})}(e,t.years),x()}).catch(function(t){console.error("Erreur:",t),e.innerHTML="<p>Erreur lors du chargement des rÃ©sultats.</p>"})}function g(e){if(!e)return!1;var t=e.toLowerCase();if("1er"===t||"vainqueur"===t)return!0;var n=e.match(/^(\d+)/);if(n){var a=parseInt(n[1],10);return a>=1&&a<=3}return!1}function E(e,t){var n="";return e.forEach(function(e){n+="<tr>",t.forEach(function(t){var a,r="";r="date"===t?function(e,t){if(!e)return"";var n=new Date(e),a=n.getDate(),r=n.getMonth();if(!t)return a+" "+d[r];var i=new Date(t),o=i.getDate(),c=i.getMonth();return r===c?a+"-"+o+" "+d[r]:a+" "+d[r]+" - "+o+" "+d[c]}(e.dateDebut,e.dateFin):e[t]||"","circuit"===t&&(e.pays&&(a=e.pays,r=(v[a]||"")+" "+r),e.manche&&(r=r+" "+e.manche)),-1!==h.indexOf(t)&&r&&(r=function(e){if(!e)return"";var t=e.toLowerCase();if("dns"===t||"dnf"===t||"annulÃ©e"===t||""===e)return e;if("1er"===t||"vainqueur"===t)return'<span class="position-badge position-1">P1</span>';var n=e.match(/^(\d+)/);if(n){var a=n[1],r=e.substring(a.length).trim(),i="position-badge";parseInt(a,10)<=3&&(i+=" position-"+a);var o='<span class="'+i+'">P'+a+"</span>";return r?o+" "+r:o}return e}(r)),"finale"===t&&(e.dnf?r+=' <span class="status-badge status-dnf">DNF</span>':e.annulee&&(r='<span class="status-badge status-annulee">AnnulÃ©e</span>')),n+="<td>"+r+"</td>"}),n+="</tr>"}),n}function b(e,t){var n=e.annee,a=document.createElement("div");a.className="season-accordion";var r=document.createElement("button");r.className="season-btn",t&&r.classList.add("active"),r.textContent="Saison "+n,r.setAttribute("aria-expanded",t?"true":"false"),r.addEventListener("click",function(){var e=this.nextElementSibling,t=this.classList.contains("active");document.querySelectorAll(".season-btn").forEach(function(e){e.classList.remove("active"),e.setAttribute("aria-expanded","false"),e.nextElementSibling&&e.nextElementSibling.classList.remove("active")}),t||(this.classList.add("active"),this.setAttribute("aria-expanded","true"),e&&e.classList.add("active"))});var i=document.createElement("div");if(i.className="season-content"+(t?" active":""),e.info)i.innerHTML='<div class="table-container"><p style="padding: 1rem; color: var(--color-text-muted);">'+e.info+"</p></div>";else{var o="";e.competitions&&e.competitions.length>0&&e.competitions.forEach(function(e){var t=e.resultat&&e.resultat.length>0;if(o+='<div class="competition-block">',o+='<div class="classement-header">',o+='<span class="classement-competition">'+e.nom+"</span>",o+='<span class="classement-categorie">'+e.categorie+"</span>",t&&(o+='<span class="classement-result">'+function(e){if(!e)return"";var t=e.match(/^(\d+)/);if(t){var n=t[1],a=e.substring(n.length).trim(),r="result-badge";parseInt(n,10)<=3&&(r+=" result-"+n);var i='<span class="'+r+'">P'+n+"</span>";return a?i+" "+a:i}return e}(e.resultat)+"</span>"),o+="</div>",e.courses&&e.courses.length>0){var n=function(e){var t=new Set;e.forEach(function(e){Object.keys(e).forEach(function(n){-1===p.indexOf(n)&&e[n]&&t.add(n)})});var n=["date","circuit"];return m.forEach(function(e){"date"!==e&&"circuit"!==e&&t.has(e)&&n.push(e)}),t.forEach(function(e){if(-1===n.indexOf(e)){var t=n.length,a=n.indexOf("finale"),r=n.indexOf("resultat");-1!==a?t=a:-1!==r&&(t=r),n.splice(t,0,e)}}),n}(e.courses);o+='<div class="table-container"><table><thead><tr>',n.forEach(function(e){o+="<th>"+function(e){return f[e]?f[e]:e.charAt(0).toUpperCase()+e.slice(1)}(e)+"</th>"}),o+="</tr></thead><tbody>",o+=E(e.courses,n),o+="</tbody></table></div>"}o+="</div>"}),i.innerHTML=o}return a.appendChild(r),a.appendChild(i),a}function y(e){var t={},n=new Set;return e.competitions.forEach(function(e){var a,r=e.annee;!r&&e.courses&&e.courses.length>0&&(r=(a=e.courses[0].dateDebut)?parseInt(a.substring(0,4),10):null),r&&(n.add(r),t[r]||(t[r]={competitions:[]}),t[r].competitions.push(e))}),e.infos&&Object.keys(e.infos).forEach(function(a){var r=parseInt(a,10);n.add(r),t[r]?t[r].info=e.infos[a]:t[r]={competitions:[],info:e.infos[a]}}),Object.keys(t).forEach(function(e){t[e].competitions.sort(function(e,t){var n=e.courses&&e.courses.length>0?e.courses[0].dateDebut:"",a=t.courses&&t.courses.length>0?t.courses[0].dateDebut:"";return(n||"").localeCompare(a||"")}),t[e].competitions.forEach(function(e){e.courses&&e.courses.length>1&&e.courses.sort(function(e,t){return(e.dateDebut||"").localeCompare(t.dateDebut||"")})})}),{byYear:t,years:Array.from(n).sort(function(e,t){return t-e})}}function x(){var c,d,f,m,p=n.value,v=a.value,h=r.value,E=i?i.value:"",y="true"===o.value,x={circuit:v,categorie:E,podium:y},C=[],L=0,S=0;if((p?[parseInt(p,10)]:l.years).forEach(function(e){var t=l.byYear[e];if(t){var n={annee:e,info:t.info,competitions:[]};t.competitions.forEach(function(e){var t,a,r=(t=e.nom,!(a=h)||t===a||-1!==t.indexOf(a)),i=!E||e.categorie===E,o=!y||g(e.resultat);if(r&&i){var c={nom:e.nom,categorie:e.categorie,resultat:e.resultat,courses:[]};e.courses&&e.courses.forEach(function(e){(function(e,t){return!(t.circuit&&e.circuit!==t.circuit||t.categorie&&e.categorie!==t.categorie||t.podium&&!g(e.finale))})(e,x)&&(c.courses.push(e),L++,(g(e.finale)||g(e.finaleB))&&S++)}),g(e.resultat)&&S++,(c.courses.length>0||o&&!v)&&n.competitions.push(c)}});var a=v||h||E||y;(n.competitions.length>0||n.info&&!a)&&C.push(n)}}),c=C,d=""!==p,e.innerHTML="",c&&c.length>0?c.forEach(function(t,n){var a=d&&0===n;e.appendChild(b(t,a))}):e.innerHTML="<p>Aucun rÃ©sultat disponible avec ces filtres.</p>",f=L,m=S,t.innerHTML=f>0?"<strong>"+f+"</strong> course(s) trouvÃ©e(s) dont <strong>"+m+"</strong> podium(s)":"Aucune course trouvÃ©e avec ces filtres",u=!1,s){var A=s.querySelector(".expand-icon"),B=s.querySelector(".expand-text");A.textContent="+",B.textContent="Tout dÃ©plier"}}}();