!function(){"use strict";var e=document.getElementById("resultats-container"),t=document.getElementById("results-count"),n=document.getElementById("filter-year"),a=document.getElementById("filter-circuit"),i=document.getElementById("filter-competition"),o=document.getElementById("filter-podium"),r=document.getElementById("filter-reset");if(e){var s=null,c=new Set,u=new Set,l={date:"Date",competition:"Compétition",circuit:"Circuit",categorie:"Catégorie",cumul:"Cumul",prefinale:"Pré-Finale",finale:"Finale",resultat:"Résultat"},d=["date","competition","circuit","categorie","prefinale","finale"];n&&n.addEventListener("change",f),a&&a.addEventListener("change",f),i&&i.addEventListener("change",f),o&&o.addEventListener("change",f),r&&r.addEventListener("click",function(){n.value="",a.value="",i.value="",o.value="",f()}),fetch("/data/resultats.json").then(function(e){if(!e.ok)throw new Error("Erreur de chargement");return e.json()}).then(function(e){s=e,function(e){e.saisons.forEach(function(e){e.courses&&e.courses.forEach(function(e){e.circuit&&c.add(e.circuit),e.competition&&u.add(e.competition)})}),e.saisons.forEach(function(e){var t=document.createElement("option");t.value=e.annee,t.textContent=e.annee,n.appendChild(t)}),Array.from(c).sort().forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=e,a.appendChild(t)}),Array.from(u).sort().forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=e,i.appendChild(t)})}(e),f()}).catch(function(t){console.error("Erreur:",t),e.innerHTML="<p>Erreur lors du chargement des résultats.</p>"})}function f(){var r,c,u,f,m=n.value,v=a.value,h=i.value,p=o.value,E={saisons:[]},g=0,L=0;s.saisons.forEach(function(e){if(!m||e.annee==m){var t={annee:e.annee,colonnes:e.colonnes,info:e.info,courses:[]};e.courses&&e.courses.forEach(function(e){v&&e.circuit!==v||h&&e.competition!==h||("true"!==p||e.podium)&&(t.courses.push(e),g++,e.podium&&L++)});var n=v||h||"true"===p;(t.courses.length>0||t.info&&!n)&&E.saisons.push(t)}}),r=E,c=""!==m,e.innerHTML="",r.saisons&&r.saisons.length>0?r.saisons.forEach(function(t,n){var a=c&&0===n;e.appendChild(function(e,t){var n=e.annee,a=document.createElement("div");a.className="season-accordion";var i=document.createElement("button");i.className="season-btn",t&&i.classList.add("active"),i.textContent="Saison "+n,i.setAttribute("aria-expanded",t?"true":"false"),i.addEventListener("click",function(){var e=this.nextElementSibling,t=this.classList.contains("active");document.querySelectorAll(".season-btn").forEach(function(e){e.classList.remove("active"),e.setAttribute("aria-expanded","false"),e.nextElementSibling&&e.nextElementSibling.classList.remove("active")}),t||(this.classList.add("active"),this.setAttribute("aria-expanded","true"),e&&e.classList.add("active"))});var o=document.createElement("div");if(o.className="season-content"+(t?" active":""),e.info)o.innerHTML='<div class="table-container"><p style="padding: 1rem; color: var(--color-text-muted);">'+e.info+"</p></div>";else if(e.courses&&e.courses.length>0){var r=e.colonnes||d,s='<div class="table-container"><table><thead><tr>';r.forEach(function(e){s+="<th>"+(l[e]||e)+"</th>"}),s+="</tr></thead><tbody>",e.courses.forEach(function(e){var t=e.podium?' class="result-podium"':"";s+="<tr"+t+">",r.forEach(function(t){var n=e[t]||"",a=e.podium&&("finale"===t||"resultat"===t);s+="<td"+(a?' class="result-highlight"':"")+">"+n+"</td>"}),s+="</tr>"}),s+="</tbody></table></div>",o.innerHTML=s}return a.appendChild(i),a.appendChild(o),a}(t,a))}):e.innerHTML="<p>Aucun résultat disponible avec ces filtres.</p>",u=g,f=L,t.innerHTML=u>0?"<strong>"+u+"</strong> course(s) trouvée(s) dont <strong>"+f+"</strong> podium(s)":"Aucune course trouvée avec ces filtres"}}();